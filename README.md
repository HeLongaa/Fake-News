# å¤šæ¨¡æ€å‡æ–°é—»æ£€æµ‹ç³»ç»Ÿ

![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)
![PyTorch](https://img.shields.io/badge/PyTorch-1.10+-orange.svg)
![Transformers](https://img.shields.io/badge/Transformers-4.0+-green.svg)
![Streamlit](https://img.shields.io/badge/Streamlit-1.28+-red.svg)
![Scikit-learn](https://img.shields.io/badge/Scikit--learn-1.0+-blueviolet.svg)

åŸºäºæ·±åº¦å­¦ä¹ çš„å¤šæ¨¡æ€ï¼ˆæ–‡æœ¬+å›¾åƒï¼‰ä¸­æ–‡å‡æ–°é—»æ£€æµ‹ç³»ç»Ÿï¼Œç»“åˆBERTå’ŒResNetå®ç°é«˜ç²¾åº¦å‡æ–°é—»è¯†åˆ«ã€‚

[Github](https://github.com/HeLongaa/Fake-News)

## é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®æ—¨åœ¨é€šè¿‡åˆ†ææ–°é—»æ–‡æœ¬å†…å®¹å’Œç›¸å…³å›¾åƒçš„ç‰¹å¾ï¼Œè‡ªåŠ¨è¯†åˆ«å’Œåˆ†ç±»çœŸå®æ–°é—»ï¼ˆæ ‡ç­¾0ï¼‰ä¸è™šå‡æ–°é—»ï¼ˆæ ‡ç­¾1ï¼‰ã€‚é¡¹ç›®ç»“åˆBERTæ–‡æœ¬ç¼–ç å’ŒResNetå›¾åƒç‰¹å¾æå–ï¼Œå¹¶é€šè¿‡å¯¹æ¯”å­¦ä¹ æ–¹æ³•æå‡æ¨¡å‹æ€§èƒ½ï¼Œå®ç°äº†é«˜æ•ˆå‡†ç¡®çš„å‡æ–°é—»æ£€æµ‹ã€‚

## æŠ€æœ¯ç‰¹ç‚¹

- ğŸ”„ **å¤šæ¨¡æ€èåˆ**ï¼šåŒæ—¶å¤„ç†æ–‡æœ¬å’Œå›¾åƒæ•°æ®ï¼Œæå–æ›´å…¨é¢çš„ç‰¹å¾
- ğŸ“ **BERTæ–‡æœ¬ç¼–ç **ï¼šä½¿ç”¨é¢„è®­ç»ƒä¸­æ–‡BERTæ¨¡å‹å¤„ç†æ–‡æœ¬ä¿¡æ¯
- ğŸ–¼ï¸ **ResNetå›¾åƒç‰¹å¾**ï¼šä½¿ç”¨ResNetç³»åˆ—æ¨¡å‹æå–å›¾åƒç‰¹å¾
- ğŸ¯ **å¯¹æ¯”å­¦ä¹ **ï¼šé€šè¿‡å¯¹æ¯”å­¦ä¹ å¢å¼ºæ¨¡å‹è¡¨ç¤ºèƒ½åŠ›
- âš™ï¸ **çµæ´»é…ç½®**ï¼šæ”¯æŒå¤šç§BERTå’ŒResNetæ¨¡å‹ç»„åˆï¼Œä¾¿äºå®éªŒå¯¹æ¯”

## æ•°æ®é›†ä»‹ç»

é¡¹ç›®ä½¿ç”¨äº†åŒ…å«9528æ¡å¸¦æœ‰å›¾åƒçš„ä¸­æ–‡å¾®åšæ•°æ®ï¼Œåˆ†ä¸ºçœŸå®æ–°é—»å’Œå‡æ–°é—»ä¸¤ç±»ï¼š

- æ¯æ¡æ•°æ®åŒ…å«å¾®åšæ–‡æœ¬å’Œå¯¹åº”å›¾åƒ
- æ–‡æœ¬æ•°æ®ç»è¿‡BERT tokenizerå¤„ç†
- å›¾åƒæ•°æ®ç»Ÿä¸€è°ƒæ•´ä¸º224Ã—224å¤§å°

æ•°æ®é¢„å¤„ç†æµç¨‹ï¼š

![æ•°æ®é¢„å¤„ç†](assets/data_pro.png)

æ•°æ®é›†æ ¼å¼ï¼š
```
path,text,label
./data/images/xxx.jpg,æ–°é—»æ–‡æœ¬å†…å®¹,1
```

## æ¨¡å‹æ¶æ„

### å¤šæ¨¡æ€èåˆæ¨¡å‹

ä¸‹å›¾å±•ç¤ºäº†æœ¬é¡¹ç›®çš„æ¨¡å‹æ•´ä½“æ¶æ„ï¼š

![æ¨¡å‹æ¶æ„å›¾](assets/model.png)

é¡¹ç›®å®ç°äº†åŸºäºBERTå’ŒResNetçš„å¤šæ¨¡æ€èåˆæ¨¡å‹ï¼Œä¸»è¦ç»„ä»¶åŒ…æ‹¬ï¼š

1. **æ–‡æœ¬ç‰¹å¾æå–**ï¼š
   - æ”¯æŒä¸‰ç§BERTæ¨¡å‹ï¼š
     * `bert-base-chinese âœ“`
     * `chinese-bert-wwm-ext âœ“`
     * `minirbt-h256`

2. **å›¾åƒç‰¹å¾æå–**ï¼š
   - æ”¯æŒäº”ç§ResNetæ¨¡å‹ï¼š
     * `resnet18`
     * `resnet34`
     * `resnet50`
     * `resnet101 âœ“`
     * `resnet152`

3. **ç‰¹å¾èåˆä¸åˆ†ç±»**ï¼š
   - å°†BERTç‰¹å¾å’ŒResNetç‰¹å¾èåˆ
   - é€šè¿‡å…¨è¿æ¥å±‚æ˜ å°„åˆ°åŒä¸€ç‰¹å¾ç©ºé—´
   - ä½¿ç”¨å¯¹æ¯”å­¦ä¹ ä¼˜åŒ–ç‰¹å¾è¡¨ç¤º
   - è¾“å‡ºäºŒåˆ†ç±»ç»“æœï¼ˆçœŸ/å‡æ–°é—»ï¼‰

### å¯¹æ¯”å­¦ä¹ 

å½“`config.usesloss=True`æ—¶ï¼Œæ¨¡å‹åŒæ—¶ä½¿ç”¨äº¤å‰ç†µæŸå¤±å’Œå¯¹æ¯”å­¦ä¹ æŸå¤±ï¼š
- äº¤å‰ç†µæŸå¤±ç”¨äºåˆ†ç±»ä»»åŠ¡
- å¯¹æ¯”å­¦ä¹ æŸå¤±ç”¨äºå¢å¼ºç‰¹å¾è¡¨ç¤º
- æœ€ç»ˆæŸå¤±ä¸ºä¸¤è€…çš„å¹³å‡å€¼

## é¡¹ç›®ç»“æ„

```
Fake-News/
â”œâ”€â”€ config.py                # é…ç½®æ–‡ä»¶
â”œâ”€â”€ data_pro.py              # æ•°æ®é¢„å¤„ç†
â”œâ”€â”€ models.py                # æ¨¡å‹å®šä¹‰
â”œâ”€â”€ resnet_models.py         # ResNetæ¨¡å‹å®ç°
â”œâ”€â”€ download_model.py        # bertæ¨¡å‹ä¸‹è½½
â”œâ”€â”€ train.py                 # æ¨¡å‹è®­ç»ƒå’Œé¢„æµ‹
â”œâ”€â”€ demo.py                  # show
â”œâ”€â”€ utils.py                 # å·¥å…·å‡½æ•°
â”œâ”€â”€ data/                    # æ•°æ®æ–‡ä»¶
â”‚   â”œâ”€â”€ readme.txt           # æ•°æ®é›†è¯´æ˜
â”‚   â”œâ”€â”€ test.csv             # æµ‹è¯•é›†
â”‚   â”œâ”€â”€ train.csv            # è®­ç»ƒé›†
â”‚   â”œâ”€â”€ val.csv              # éªŒè¯é›†
â”‚   â””â”€â”€ images/              # å›¾åƒæ–‡ä»¶å¤¹
â””â”€â”€ bert_model/              # é¢„è®­ç»ƒBERTæ¨¡å‹
    â”œâ”€â”€ bert-base-chinese/
    â”œâ”€â”€ chinese-bert-wwm-ext/
    â””â”€â”€ minirbt-h256/
```

## é…ç½®è¯´æ˜

ä¸»è¦é…ç½®å‚æ•°ï¼ˆåœ¨`config.py`ä¸­ï¼‰ï¼š

```python
# è®­ç»ƒå‚æ•°
self.num_epochs = 20      # è®­ç»ƒè½®æ•°
self.batch_size = 32      # æ‰¹æ¬¡å¤§å°
self.pad_size = 128       # æ–‡æœ¬æœ€å¤§é•¿åº¦

# å­¦ä¹ ç‡è®¾ç½®
self.bert_learning_rate = 1e-5    # BERTå­¦ä¹ ç‡
self.resnet_learning_rate = 2e-5  # ResNetå­¦ä¹ ç‡
self.other_learning_rate = 2e-5   # å…¶ä»–å±‚å­¦ä¹ ç‡

# æ¨¡å‹é€‰æ‹©
self.bert_name = 'bert_model/minirbt-h256'  # BERTæ¨¡å‹ç±»å‹
self.resnet_name = 'resnet18'               # ResNetæ¨¡å‹ç±»å‹
self.usesloss = True                        # æ˜¯å¦ä½¿ç”¨å¯¹æ¯”å­¦ä¹ 
```

## ä½¿ç”¨æ–¹æ³•

### ç¯å¢ƒé…ç½®

```bash
# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### æ•°æ®é¢„å¤„ç†

```bash
python data_pro.py
```

### è®­ç»ƒæ¨¡å‹

```bash
python train.py
```

### ç»“æœå¯è§†åŒ–

bert-base-chinese_resnet18æ˜¯æ¨¡å‹åç§°
```bash
tensorboard --logdir=log/bert-base-chinese_resnet18 --port=6006
```

### ä¿®æ”¹é…ç½®

åœ¨`config.py`ä¸­ä¿®æ”¹ä»¥ä¸‹å‚æ•°è¿›è¡Œå®éªŒï¼š
- æ›´æ”¹BERTæ¨¡å‹ï¼šä¿®æ”¹`self.bert_name`
- æ›´æ”¹ResNetæ¨¡å‹ï¼šä¿®æ”¹`self.resnet_name`
- è°ƒæ•´å­¦ä¹ ç‡ï¼šä¿®æ”¹`self.bert_learning_rate`ç­‰å‚æ•°
- å¯¹æ¯”å­¦ä¹ ï¼šä¿®æ”¹`self.usesloss`

## è¯„ä¼°æŒ‡æ ‡

- å‡†ç¡®ç‡ï¼ˆAccuracyï¼‰
- åˆ†ç±»æŠ¥å‘Šï¼ˆClassification Reportï¼‰
- æŸå¤±æ›²çº¿ï¼ˆé€šè¿‡TensorBoardå¯è§†åŒ–ï¼‰

## è¿è¡Œè¦æ±‚

- Python 3.8+
- PyTorch 1.10+
- Transformers 4.0+
- CUDAæ”¯æŒï¼ˆæ¨èç”¨äºåŠ é€Ÿè®­ç»ƒï¼‰
- è‡³å°‘8GBæ˜¾å­˜ï¼ˆå¯¹äºè¾ƒå¤§æ¨¡å‹å¦‚ResNet101ï¼‰

## æ³¨æ„äº‹é¡¹

- é¦–æ¬¡è¿è¡Œéœ€è¦ä¸‹è½½é¢„è®­ç»ƒçš„BERTæ¨¡å‹
   ```bash
   python download_model.py
   ```
- æ·±åº¦å­¦ä¹ æ¨¡å‹éœ€è¦è¾ƒé«˜çš„è®¡ç®—èµ„æº
- å¯¹äº`minirbt-h256`æ¨¡å‹ï¼Œæ›´å¤§çš„å­¦ä¹ ç‡æ•ˆæœæ›´å¥½

## å‚è€ƒ

[Hierarchical Multi-modal Contextual Attention Network for Fake News Detection](https://dl.acm.org/doi/10.1145/3404835.3462871)
